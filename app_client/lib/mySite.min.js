angular.module("toggle-switch",["ng"]).directive("toggleSwitch",["$compile",function(e){return{restrict:"EA",replace:true,require:"ngModel",scope:{isDisabled:"=",onLabel:"@",offLabel:"@",knobLabel:"@",html:"=",onChange:"&"},template:'<div class="ats-switch" ng-click="toggleSwitch()" ng-keypress="onKeyPress($event)" ng-class="{ \'disabled\': isDisabled }" role="switch" aria-checked="{{!!model}}">'+"<div class=\"switch-animate\" ng-class=\"{'switch-off': !model, 'switch-on': model}\">"+'<span class="switch-left"></span>'+'<span class="knob"></span>'+'<span class="switch-right"></span>'+"</div>"+"</div>",compile:function(t,n){if(angular.isUndefined(n.onLabel)){n.onLabel="On"}if(angular.isUndefined(n.offLabel)){n.offLabel="Off"}if(angular.isUndefined(n.knobLabel)){n.knobLabel="Â "}if(angular.isUndefined(n.isDisabled)){n.isDisabled=false}if(angular.isUndefined(n.html)){n.html=false}if(angular.isUndefined(n.tabindex)){n.tabindex=0}return function t(r,o,i,a){o.attr("tabindex",n.tabindex);r.toggleSwitch=function e(){if(!r.isDisabled){r.model=!r.model;a.$setViewValue(r.model)}r.onChange()};var s=32;r.onKeyPress=function e(t){if(t.charCode==s&&!t.altKey&&!t.ctrlKey&&!t.metaKey){r.toggleSwitch();t.preventDefault()}};a.$formatters.push(function(e){return e});a.$parsers.push(function(e){return e});a.$viewChangeListeners.push(function(){r.$eval(n.ngChange)});a.$render=function(){r.model=a.$viewValue};var l=function(t,n){t=angular.element(t);var o=n===true?"ng-bind-html":"ng-bind";t.removeAttr("ng-bind-html");t.removeAttr("ng-bind");if(angular.element(t).hasClass("switch-left"))t.attr(o,"onLabel");if(t.hasClass("knob"))t.attr(o,"knobLabel");if(t.hasClass("switch-right"))t.attr(o,"offLabel");e(t)(r,function(e,n){t.replaceWith(e)})};var c=function(e,t){angular.forEach(e[0].children[0].children,function(e,n){l(e,t)})};r.$watch("html",function(e){c(o,e)})}}}}]);(function(e){var t=function(e){var t=e.module("FSAngular",[]);t.factory("Fullscreen",["$document","$rootScope",function(t,n){var r=t[0];var o=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT;var i=n.$new();t.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){i.$emit("FSFullscreen.change",a.isEnabled())});var a={$on:e.bind(i,i.$on),all:function(){a.enable(r.documentElement)},enable:function(e){if(e.requestFullScreen){e.requestFullScreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.webkitRequestFullscreen){if(/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)){e.webkitRequestFullscreen()}else{e.webkitRequestFullscreen(o)}}else if(e.msRequestFullscreen){e.msRequestFullscreen()}},cancel:function(){if(r.cancelFullScreen){r.cancelFullScreen()}else if(r.mozCancelFullScreen){r.mozCancelFullScreen()}else if(r.webkitExitFullscreen){r.webkitExitFullscreen()}else if(r.msExitFullscreen){r.msExitFullscreen()}},isEnabled:function(){var e=r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement;return e?true:false},toggleAll:function(){a.isEnabled()?a.cancel():a.all()},isSupported:function(){var e=r.documentElement;var t=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen;return t?true:false}};return a}]);t.directive("fullscreen",["Fullscreen",function(e){return{link:function(t,n,r){if(r.fullscreen){t.$watch(r.fullscreen,function(t){var r=e.isEnabled();if(t&&!r){e.enable(n[0]);n.addClass("isInFullScreen")}else if(!t&&r){e.cancel();n.removeClass("isInFullScreen")}});var o=e.$on("FSFullscreen.change",function(e,o){if(!o){t.$evalAsync(function(){t.$eval(r.fullscreen+"= false");n.removeClass("isInFullScreen")})}});t.$on("$destroy",function(){o()})}else{if(r.onlyWatchedProperty!==undefined){return}n.on("click",function(t){e.enable(n[0])})}}}}]);return t};if(typeof define==="function"&&define.amd){define("FSAngular",["angular"],function(e){return t(e)})}else if(typeof module!=="undefined"&&module.exports){module.exports=t(e.angular).name}else{t(e.angular)}})(window);!function(e,t){if(typeof module!="undefined"&&module.exports)module.exports=t();else if(typeof define=="function"&&define.amd)define(t);else this[e]=t()}("bowser",function(){var e=true;function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}var o=n(/(ipod|iphone|ipad)/i).toLowerCase(),i=/like android/i.test(t),a=!i&&/android/i.test(t),s=/CrOS/.test(t),l=/silk/i.test(t),c=/sailfish/i.test(t),u=/tizen/i.test(t),f=/(web|hpw)os/i.test(t),d=/windows phone/i.test(t),m=!d&&/windows/i.test(t),g=!o&&!l&&/macintosh/i.test(t),p=!a&&!c&&!u&&!f&&/linux/i.test(t),h=n(/edge\/(\d+(\.\d+)?)/i),v=n(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(t),y=!b&&/[^-]mobi/i.test(t),w;if(/opera|opr/i.test(t)){w={name:"Opera",opera:e,version:v||n(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}}else if(/yabrowser/i.test(t)){w={name:"Yandex Browser",yandexbrowser:e,version:v||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}}else if(d){w={name:"Windows Phone",windowsphone:e};if(h){w.msedge=e;w.version=h}else{w.msie=e;w.version=n(/iemobile\/(\d+(\.\d+)?)/i)}}else if(/msie|trident/i.test(t)){w={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else if(s){w={name:"Chrome",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(/chrome.+? edge/i.test(t)){w={name:"Microsoft Edge",msedge:e,version:h}}else if(/chrome|crios|crmo/i.test(t)){w={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(o){w={name:o=="iphone"?"iPhone":o=="ipad"?"iPad":"iPod"};if(v){w.version=v}}else if(c){w={name:"Sailfish",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}}else if(/seamonkey\//i.test(t)){w={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}}else if(/firefox|iceweasel/i.test(t)){w={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)};if(/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)){w.firefoxos=e}}else if(l){w={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}}else if(a){w={name:"Android",version:v}}else if(/phantom/i.test(t)){w={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}}else if(/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)){w={name:"BlackBerry",blackberry:e,version:v||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}}else if(f){w={name:"WebOS",webos:e,version:v||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)};/touchpad\//i.test(t)&&(w.touchpad=e)}else if(/bada/i.test(t)){w={name:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}}else if(u){w={name:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||v}}else if(/safari/i.test(t)){w={name:"Safari",safari:e,version:v}}else{w={name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)}}if(!w.msedge&&/(apple)?webkit/i.test(t)){w.name=w.name||"Webkit";w.webkit=e;if(!w.version&&v){w.version=v}}else if(!w.opera&&/gecko\//i.test(t)){w.name=w.name||"Gecko";w.gecko=e;w.version=w.version||n(/gecko\/(\d+(\.\d+)?)/i)}if(!w.msedge&&(a||w.silk)){w.android=e}else if(o){w[o]=e;w.ios=e}else if(m){w.windows=e}else if(g){w.mac=e}else if(p){w.linux=e}var k="";if(w.windowsphone){k=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}else if(o){k=n(/os (\d+([_\s]\d+)*) like mac os x/i);k=k.replace(/[_\s]/g,".")}else if(a){k=n(/android[ \/-](\d+(\.\d+)*)/i)}else if(w.webos){k=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i)}else if(w.blackberry){k=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i)}else if(w.bada){k=n(/bada\/(\d+(\.\d+)*)/i)}else if(w.tizen){k=n(/tizen[\/\s](\d+(\.\d+)*)/i)}if(k){w.osversion=k}var S=k.split(".")[0];if(b||o=="ipad"||a&&(S==3||S==4&&!y)||w.silk){w.tablet=e}else if(y||o=="iphone"||o=="ipod"||a||w.blackberry||w.webos||w.bada){w.mobile=e}if(w.msedge||w.msie&&w.version>=10||w.yandexbrowser&&w.version>=15||w.chrome&&w.version>=20||w.firefox&&w.version>=20||w.safari&&w.version>=6||w.opera&&w.version>=10||w.ios&&w.osversion&&w.osversion.split(".")[0]>=6||w.blackberry&&w.version>=10.1){w.a=e}else if(w.msie&&w.version<10||w.chrome&&w.version<20||w.firefox&&w.version<20||w.safari&&w.version<6||w.opera&&w.version<10||w.ios&&w.osversion&&w.osversion.split(".")[0]<6){w.c=e}else w.x=e;return w}var n=t(typeof navigator!=="undefined"?navigator.userAgent:"");n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if(typeof r==="string"){if(r in n){return true}}}return false};n._detect=t;return n});(function(){angular.module("mySite",["ui.bootstrap","ui.calendar","ngRoute"]).value("bowser",bowser);function e(e,t){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("mySite").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("mySite").service("videoManip",e);function e(){var e=function(e){var t=angular.element(document.querySelector("#"+e));t[0].pause()};var t=function(e){var t=angular.element(document.querySelector("#"+e));t[0].play()};var n=function(e){var t=angular.element(document.querySelector("#"+e));return!t[0].paused};return{pause:e,play:t,isPlaying:n}}})();(function(){angular.module("mySite").service("browserDetector",e);e.$inject=["bowser"];function e(e){var t=function(){return e.msie&&e.version<9};var n=function(){return e.msie};return{isLtIe9:t,isIe:n}}})();(function(){angular.module("mySite").service("mySiteData",e);e.$inject=["$http"];function e(e){var t=function(){return e.get("/api/blogs")};var n=function(t){return e.get("/api/blog/"+t)};var r=function(t,n){return e.post("/api/locations/"+t+"/reviews",n,{headers:{Authorization:"Bearer "+authentication.getToken()}})};return{blogs:t,blogById:n,addReviewById:r}}})();(function(){angular.module("mySite").service("authentication",e);e.$inject=["$window","$http"];function e(e,t){var n=function(t){e.localStorage["mySite-token"]=t};var r=function(){return e.localStorage["mySite-token"]};var o=function(e){return t.post("/api/register",e).success(function(e){n(e.token)})};var i=function(e){return t.post("/api/login",e).success(function(e){n(e.token)})};var a=function(){e.localStorage.removeItem("mySite-token")};var s=function(){var t=r();if(t){var n=JSON.parse(e.atob(t.split(".")[1]));return n.exp>Date.now()/1e3}else{return false}};var l=function(){if(s()){var t=r();var n=JSON.parse(e.atob(t.split(".")[1]));return{email:n.email,name:n.name,screenname:n.screenname,fbid:n.fbid,fbname:n.fbname,fbemail:n.fbemail,preferences:n.preferences}}};var c=function(e){var t=["aol.com","att.net","comcast.net","facebook.com","gmail.com","gmx.com","googlemail.com","google.com","hotmail.com","hotmail.co.uk","mac.com","me.com","mail.com","msn.com","live.com","sbcglobal.net","verizon.net","yahoo.com","yahoo.co.uk","email.com","games.com","gmx.net","hush.com","hushmail.com","icloud.com","inbox.com","lavabit.com","love.com","outlook.com","pobox.com","rocketmail.com","safe-mail.net","wow.com","ygm.com","ymail.com","zoho.com","fastmail.fm","bellsouth.net","charter.net","comcast.net","cox.net","earthlink.net","juno.com","btinternet.com","virginmedia.com","blueyonder.co.uk","freeserve.co.uk","live.co.uk","ntlworld.com","o2.co.uk","orange.net","sky.com","talktalk.co.uk","tiscali.co.uk","virgin.net","wanadoo.co.uk","bt.com","sina.com","qq.com","naver.com","hanmail.net","daum.net","nate.com","yahoo.co.jp","yahoo.co.kr","yahoo.co.id","yahoo.co.in","yahoo.com.sg","yahoo.com.ph","hotmail.fr","live.fr","laposte.net","yahoo.fr","wanadoo.fr","orange.fr","gmx.fr","sfr.fr","neuf.fr","free.fr","gmx.de","hotmail.de","live.de","online.de","t-online.de","web.de","yahoo.de","mail.ru","rambler.ru","yandex.ru","ya.ru","list.ru","hotmail.be","live.be","skynet.be","voo.be","tvcablenet.be","telenet.be","hotmail.com.ar","live.com.ar","yahoo.com.ar","fibertel.com.ar","speedy.com.ar","arnet.com.ar","hotmail.com","gmail.com","yahoo.com.mx","live.com.mx","yahoo.com","hotmail.es","live.com","hotmail.com.mx","prodigy.net.mx","msn.com"];return e.indexOf("@")>0&&e.indexOf("@")<e.length&&e.indexOf(".")>0&&e.indexOf(".")<e.length&&t.indexOf(e.split("@")[1])>-1};var u=function(r){return t.post("/api/addfb",r).success(function(t){e.localStorage.removeItem("mySite-token");n(t.token)})};var f=function(r){return t.post("/api/updpref",r).success(function(t){e.localStorage.removeItem("mySite-token");n(t.token)})};return{saveToken:n,getToken:r,register:o,login:i,logout:a,isLoggedIn:s,currentUser:l,isEmail:c,addFB:u,updatePreferences:f}}})();(function(){angular.module("mySite").service("imageMan",e);e.$inject=["facebook","$rootScope","$http"];function e(e,t,n){var r;var o;var i={};var a=[];var s=-1;var l={};var c={};var u={};var f={};function d(e){r=e}function m(e){o=e;if(o.preferences.fbGroupIds.length<Object.keys(c).length){for(var t in c){t=parseInt(t);if(o.preferences.fbGroupIds.indexOf(t)==-1){delete c[t];delete u[t];delete f[t];delete l[t];delete i[t]}}}}function g(e,t,n,r){if(c[r]==="done"){c[r]=l[r].length;l[r].push({message:e,attachment:t,height:n})}else{l[r].splice(c[r],0,{message:e,attachment:t,height:n})}}function p(t,n,r,o,i,a){if(o<n.length){if(n[o].media&&n[o].media.image&&n[o].type=="photo"){var s=n[o].target.id;console.log("API: "+"/"+s+"?fields=images");var l=e.api("/"+s+"?fields=images");l.then(function(e){var s=e.images[0].source;var l=e.images[0].height;g(a,s,l,r);p(t,n,r,o+1,i,a)},function(e){alert("FAILED: "+JSON.stringify(e))})}else{p(t,n,r,o+1,i,a)}}else{h(t,r,i)}}function h(t,n,o){console.log("I: "+o+" DATAL: "+t.length);if(o<t.length){var i="";var a;if(!t[o].message&&t[o].story){i=t[o].story}else{i=t[o].message}if(t[o].attachments!=null){if(t[o].attachments.data[0].subattachments!=null){var s=t[o].attachments.data[0].subattachments.data;p(t,s,n,0,o+1,i)}else{if(t[o].attachments.data[0].media&&t[o].attachments.data[0].media.image&&t[o].attachments.data[0].type=="photo"){var l=t[o].attachments.data[0].target.id;console.log("API: "+"/"+l+"?fields=images");var c=e.api("/"+l+"?fields=images");c.then(function(e){var r=e.images[0].source;var a=e.images[0].height;g(i,r,a,n);h(t,n,o+1)},function(e){alert("FAILED: "+JSON.stringify(e))})}else{h(t,n,o+1)}}}else{h(t,n,o+1)}}else{if(!r){S()}}}function v(){var e=a.slice(s+1,a.length);var t=a.slice(0,s+1);a=e.concat(t);s=a.length-1}function b(e){var t=e.config.url.split("/")[4];var e=e.data;var r=0;while(r<e.data.length&&u[t].diff(moment(e.data[r].created_time))<0){i[t].push(e.data[r]);r=r+1}if(r==e.data.length&&r>0){n.get(e.paging.next).then(b)}else{v();y(i[t],t);u[t]=f[t]}}function y(e,t){var n=e;if(!l[t]){l[t]=[]}if(!c[t]){c[t]=0}h(n,t,0)}function w(){console.log("TROLLING......");if(o.preferences&&o.preferences.fbGroupIds){var t=o.preferences.fbGroupIds.length;for(groupInd=0;groupInd<t;groupInd++){var r=o.preferences.fbGroupIds[groupInd];console.log("API: "+"/"+r+"?fields=feed{created_time,message,story,attachments},id");var a=e.api("/"+r+"?fields=feed{created_time,message,story,attachments},id");a.then(function(e){var t=e.id;latestGroupUpdateTime=moment(e.feed.data[0].created_time);if(u[t]){if(u[t].diff(latestGroupUpdateTime)<0){i[e.id]=[];var r=0;while(r<e.feed.data.length&&u[t].diff(moment(e.feed.data[r].created_time))<0){i[e.id].push(e.feed.data[r]);r=r+1}if(r==e.feed.data.length&&r>0){n.get(e.feed.paging.next).then(b)}else if(r>0){v();y(i[e.id],e.id);u[e.id]=latestGroupUpdateTime}f[t]=latestGroupUpdateTime}else{}}else{i[e.id]=[];u[t]=moment("1950-03-17T00:00:00+0000");var r=0;while(r<e.feed.data.length&&u[t].diff(moment(e.feed.data[r].created_time))<0){i[e.id].push(e.feed.data[r]);r=r+1}if(r==e.feed.data.length&&r>0){n.get(e.feed.paging.next).then(b)}else if(r>0){v();y(i[e.id],e.id);u[e.id]=latestGroupUpdateTime}f[t]=latestGroupUpdateTime}setTimeout(w,1e3*60*5)},function(e){alert("FAILED: "+JSON.stringify(e))})}}else{console.log("Please add social media source.")}}function k(e){var t;if(document.getElementById("imgDiv")){var n=document.getElementById("imgDiv").clientWidth-40;for(t=0;t<e.length;t++){console.log("width: "+e[t].width+" Page W: "+n);if(e[t].width>n){continue}else{return e[t]}}return e[t]}return""}var S=function(){console.log("GolbalONBefore: "+s);console.log("GlobalPicsBefore: "+JSON.stringify(a));if(a.length>s+1){r=a[s+1];s++}else if($()){s=0;r=a[s]}else{console.log("onData: "+JSON.stringify(c));do{groupInd=Math.floor(Math.random()*Object.keys(c).length)}while(c[o.preferences.fbGroupIds[groupInd]]==="done");console.log("groupInd: "+groupInd+" LENGTH: "+Object.keys(c).length);var e=o.preferences.fbGroupIds[groupInd];r=l[e][c[e]];if(l[e].length-1==c[e]){c[e]="done"}else{c[e]=c[e]+1}s++;a[s]=r}t.$broadcast("UpdatedFBData",r);console.log("GlobalPicsAfter: "+JSON.stringify(a));console.log("GolbalONAfter: "+s)};var $=function(){var e=true;for(var t in c){if(c[t]!=="done"){e=false}}return e};var I=function(){console.log("GolbalONBefore: "+s);if(s!=0){r=a[s-1];s--}else{s=a.length-1;r=a[s]}t.$broadcast("UpdatedFBData",r);console.log("GolbalONAfter: "+s)};return{prevPic:I,nextPic:S,trollForGroupsUpdates:w,setFBData:d,setUser:m}}})();(function(){angular.module("mySite").controller("homeCtrl",e);e.$inject=["$location","browserDetector","videoManip","mySiteData","authentication"];function e(e,t,n,r,o){var i=this;var a="I am getting nausious...";var s="Much Better.";i.pauseplayIcon="pause";i.pauseplayCap=a;i.toFantasy=function(){$window.location.href("/fan/home")};i.pageHeader={title:"Welcome to Big Al's Site!",strapline:"Where all of my dreams come true..."};i.pauseplay=function(){var e="bgvid";if(n.isPlaying(e)){n.pause(e);i.pauseplayIcon="play";i.pauseplayCap=s}else{n.play(e);i.pauseplayIcon="pause";i.pauseplayCap=a}};i.webm="/videos/deep_blue_sky.webm";i.mp4="/videos/deep_blue_sky.mp4";i.img="/images/welcome_image.jpeg";i.yahooimg="/images/yahoo.png";i.calimg="/images/calendar.png";i.blogimg="/images/blog.png";i.fbimg="/images/facebook.png";var l=function(e){i.blogData=e.data};var c=function(e){console.log(e);i.pageHeader={title:"error in api"}};r.blogs().then(l,c);i.goTo=function(t){e.path("/blog/"+t)};i.currentPath=e.path();i.isLoggedIn=o.isLoggedIn();i.currentUser=o.currentUser();i.logout=function(){o.logout();i.isLoggedIn=false;e.path("/")}}})();(function(){angular.module("mySite").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var n=this;n.pageHeader={title:"Sign in to mySite"};n.credentials={email:"",username:"",screenname:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doLogin()}};n.doLogin=function(){n.formError="";t.login(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();(function(){angular.module("mySite").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var n=this;n.pageHeader={title:"Create a new account for mySite"};n.credentials={screenname:"",username:"",email:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!t.isEmail(n.credentials.email)){n.formError="Please enter a valid email address";return false}else if(!n.credentials.screenname||!n.credentials.username||!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else if(n.credentials.username.indexOf("@")>-1){n.formError="Please do not use the character '@' in your username";return false}else{n.doRegister()}};n.doRegister=function(){n.formError="";t.register(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();(function(){angular.module("mySite").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("mySite").directive("blogList",e);function e(){return{restrict:"EA",scope:{data:"=data"},templateUrl:"/common/directives/blogList/blogList.template.html"}}})();(function(){angular.module("mySite").directive("backgroundVideo",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/background_video/background_video.template.html"}}})();(function(){angular.module("mySite").controller("calCtrl",e);e.$inject=["browserDetector","mySiteData"];function e(e,t){var n=this;n.pageHeader={title:"Welcome to Big Al's Calendar!",strapline:"Schedule your hearts desires"};n.clearTimes=function(){if(n.event.allDay){n.event.end=null;n.event.start=null}else{n.eventWarning=""}};var r=function(e){var t=[];e=e+"";t=e.split(" ");tz=t[5];e=t[4];t=e.split(":");t=[t[0],t[1]];e=t.join(":");tz=tz.split("GMT")[1].substr(0,3)+":00";e=e+tz;return e};n.eventSubmit=function(){var e={};n.formError="";if(!n.event.title){n.formError="Please fill out title."}if(!n.event.start&&!n.event.end){if(!n.event.allDay){n.formError="Please submit time for event."}}if(n.formError){return false}var t=n.eventDate;e.title=n.event.title;e.start=n.event.allDay?t:t+"T"+r(n.event.start);if(n.event.end&&!n.event.allDay){e.end=t+"T"+r(n.event.end)}e.allDay=n.event.allDay;n.doAddEvent(e)};n.unselect=function(){n.dateSelected=false};n.doAddEvent=function(e){n.events.push(e);if($("#lgcalendar").is(":visible")){$("#lgcalendar").fullCalendar("refetchEvents")}else{$("#smcalendar").fullCalendar("refetchEvents")}n.unselect()};n.eventTimeWarning=function(){if(n.event.allDay){n.eventWarning="Warning: if 'All Day' is selected, other times will be ignored."}};n.alertEventOnClick=function(e,t,r){n.dateSelected=true;n.eventDate=e.format()};n.dateSelected=false;n.events=[];n.eventSources={events:function(e,t,r,o){o(n.events)}};n.uiConfig={bigcalendar:{editable:true,selectable:true,header:{left:"month basicWeek agendaDay",center:"title",right:"today prev,next"},dayClick:n.alertEventOnClick,eventDrop:n.alertOnDrop,eventResize:n.alertOnResize},smallcalendar:{editable:true,selectable:true,header:{left:"prev",center:"title",right:"next"},dayClick:n.alertEventOnClick,eventDrop:n.alertOnDrop,eventResize:n.alertOnResize,defaultView:"basicDay"}};if(e.isLtIe9()){}}})();(function(){angular.module("myCalendar",["ui.bootstrap","ui.calendar","ngRoute"]).value("bowser",bowser);function e(e,t){e.when("/calendar",{templateUrl:"/app_calendar/views/home.html",controller:"calCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("myCalendar",["mySite"]).config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("mySite").controller("blogCtrl",e);e.$inject=["$routeParams","mySiteData"];function e(e,t){var n=this;n.pageHeader={title:"Welcome to Big Al's Blog!",strapline:"Where you get to hear about all my dreams!"};var r=function(e){n.blogData=e.data};var o=function(e){console.log(e);n.pageHeader={title:"error in api"}};t.blogs().then(r,o);n.goTo=function(e){$location.path("/blog/"+e)}}})();(function(){angular.module("myBlog",["ui.bootstrap","ngRoute"]).value("bowser",bowser);function e(e,t){e.when("/blog",{templateUrl:"/app_blog/views/home.html",controller:"blogCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("myBlog",["mySite"]).config(["$routeProvider","$locationProvider",e])})();angular.module("bnx.module.facebook",[]).provider("facebook",facebookProvider);facebookProvider.$inject=["$injector"];function facebookProvider(e){this.initialized=false;var t={appId:"",status:true,cookie:true,xfbml:true,version:"v2.8"};var n={auth:["authResponseChange","statusChange","login","logout"]};var r=[];this.init=function(e){window.fbAsyncInit=function(){angular.extend(t,e);FB.init(t);this.initialized=true;i()}};function o(e,t,n){r.push([e,t,n])}var i=function(){while(item=r.shift()){func=item[0];self=item[1];args=item[2];func.apply(self,args)}};this.$get=["$rootScope","$q",function(e,t){var r=function(n){var r=t.defer();n(function(t){if(t&&t.error){r.reject(t)}else{r.resolve(t)}e.$apply()});return r.promise};var i=function(){e.$broadcast("fb.init",{});angular.forEach(n,function(t,n){angular.forEach(t,function(t){var r="fb."+n+"."+t;FB.Event.subscribe(n+"."+t,function(t){e.$broadcast(r,t)})})})};var a=function(e){return r(function(t){FB.login(function(e){t(e)},e)})};var s=function(){return r(function(e){FB.getLoginStatus(function(t){e(t)})})};var l=function(e){console.log("Executing Api Call");return r(function(t){FB.api(e,function(e){t(e)})})};if(!this.initialized){o(i,this,[])}else{i()}var c=this;return{initialized:function(){return c.initialized},loginStatus:s,init:c.init,api:l,login:a}}]}(function(){angular.module("mySite").controller("socialCtrl",e);e.$inject=["$routeParams","mySiteData","facebook","$rootScope","$window","Fullscreen","$q","authentication","imageMan"];function e(e,t,n,r,o,i,a,s,l){var c=this;c.fbData;c.login=y;c.fbLoggedIn=true;c.nextPic=v;c.prevPic=b;c.isFullscreen=false;c.autoPlay=false;c.toggleFullScreen=g;c.toggleAutoPlay=p;c.user=s.currentUser()||{};c.loading=false;var u=i.isSupported();var f=3e3;$("#progBarContainer").css("padding-top",$("#progBarContainer").height()/2-$("#progBar").height()/2);$(window).resize(function(){d()});function d(e){var t=angular.element($("#theatre")).prop("offsetTop");var n=$(window).height();c.remainingHeight=n-t-$("#imgMessage").outerHeight(true)-(e||0);$("#theatre").css("height",c.remainingHeight);$("#img1").css("max-height",c.remainingHeight)}d(50);var m=function(e){var t=a.defer();e(function(e){if(e&&e.error){t.reject(e)}else{t.resolve(e)}});return t.promise};function g(){if(u){c.isFullscreen=!c.isFullscreen}else{alert("Your browser does not support this fullscreen, please update your browser.")}}function p(){c.autoPlay=!c.autoPlay;if(c.autoPlay){h()}}function h(){var e=m(function(e){if(c.autoPlay){l.nextPic()}e()});e.then(function(e){if(c.autoPlay){setTimeout(h,f)}},function(e){alert("FAILED: "+JSON.stringify(e))})}function v(){l.nextPic()}function b(){l.prevPic()}r.$on("UpdatedPreferences",function(e,t){console.log("Event Upd Pref: "+JSON.stringify(t));c.user=t;if(!c.fbData){c.loading=true}l.setUser(c.user);l.setFBData(c.fbData);l.trollForGroupsUpdates()});r.$on("UpdatedFBData",function(e,t){c.fbData=t;c.loading=false});function y(){var e=n.login({scope:"public_profile,user_friends,email"});e.then(function(e){},function(e){alert("FAILED: "+JSON.stringify(e))})}r.$on("fb.init",function(e,t){console.log("Event FB Init: "+JSON.stringify(t));var r=n.loginStatus();r.then(function(e){if(e.status==="connected"){c.fbLoggedIn=true;var t=s.currentUser();if(s.isLoggedIn()&&!t.fbid){w(t)}if(c.user.preferences){if(!c.fbData&&c.user.preferences.fbGroupIds.length>0){c.loading=true}l.setUser(c.user);l.setFBData(c.fbData);l.trollForGroupsUpdates()}}else{c.fbLoggedIn=false}},function(e){alert("FAILED: "+JSON.stringify(e))})});function w(e){var t=n.api("/me/?fields=email,name,id");t.then(function(t){var n={name:t.name,id:t.id,fbemail:t.email,email:e.email};s.addFB(n).error(function(e){console.log(e)}).then(function(){console.log("Added FB");c.user=s.currentUser()})},function(e){alert("FAILED: "+JSON.stringify(e))})}r.$on("fb.auth.login",function(e,t){console.log("Event FB Logged In: "+JSON.stringify(t));var n=s.currentUser();if(s.isLoggedIn()&&!n.fbid){w(n)}c.fbLoggedIn=true;if(!c.fbData&&c.user.preferences.fbGroupIds.length>0){c.loading=true}l.setUser(c.user);l.setFBData(c.fbData);l.trollForGroupsUpdates()});c.pageHeader={title:"Welcome to Big Al's Social!",strapline:"Where you get to see social media streams!"}}})();(function(){angular.module("mySocialStream",["bnx.module.facebook","ui.bootstrap","ngRoute","jtt_instagram"]).value("bowser",bowser);function e(e,t){e.when("/social",{templateUrl:"/app_social_stream/views/home.html",controller:"socialCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("mySocialStream",["mySite","bnx.module.facebook","ngTouch","FSAngular","toggle-switch","jtt_instagram"]).config(["$routeProvider","$locationProvider","facebookProvider",e])})();(function(){angular.module("bnx.module.facebook").directive("facebookLogin",e);function e(){return{restrict:"E",scope:{content:"=content",autoLogout:"@",size:"@",showFaces:"@",scope:"@"},templateUrl:"/app_social_stream/directives/facebookLogin.template.html"}}})();(function(){angular.module("bnx.module.facebook").directive("facebook",e);e.$inject=["$location","facebook"];function e(e,t){var n=document.createElement("script");n.src="//connect.facebook.net/en_US/sdk.js";n.id="facebook-jssdk";n.async=true;return{restrict:"EA",templateUrl:"/app_social_stream/directives/facebook.template.html",scope:{content:"=content",appId:"@",parameters:"="},link:function(e,r,o){if(!t.initialized()){document.body.appendChild(n);var i=e.parameters||{};angular.extend(i,{appId:e.appId});t.init(i)}}}}})();(function(){angular.module("mySocialStream").controller("socialCtrlNavbar",t).directive("navbar",e);function e(){return{restrict:"EA",templateUrl:"/app_social_stream/directives/navbar.template.html",controller:"socialCtrlNavbar",controllerAs:"vm",scope:{content:"=content",parameters:"="}}}t.$inject=["facebook","authentication","$rootScope","$http","$window","$routeParams","$http","$location","instagramFactory"];function t(e,t,n,r,o,i,r,a,s){var l=this;access_token="";l.user=t.currentUser()||{};l.foundGroup=false;l.groupId=0x5babc437bf258;l.hashtag="glasses";l.findGroup=d;l.addGroup=m;l.groupErr="";l.groupName="";l.groupPic="";l.groupIdChanged=c;l.removeGroup=f;l.findHash=g;l.addHash=p;l.hashtagChanged=u;l.instaAuth=a.hash().split("=")[a.hash().split("=").length-1];function c(){l.groupErr="";l.foundGroup=false}function u(){l.hashErr="";l.foundHash=false}function f(e){console.log("NAME: "+e);if(l.user.preferences){if(l.user.preferences.fbGroupNames){if(!!(l.user.preferences.fbGroupNames.indexOf(e)+1)){var r=l.user.preferences.fbGroupNames.indexOf(e);l.user.preferences.fbGroupNames.splice(r,1);l.user.preferences.fbGroupIds.splice(r,1)}else{console.log("something is wrong here Duplicate...")}}else{console.log("something is wrong here Names...")}}else{console.log("something is wrong here Pref...")}if(t.isLoggedIn()){var o={preferences:l.user.preferences,email:l.user.email};t.updatePreferences(o).error(function(e){l.groupErr=e}).then(function(){console.log("Updated Preferences");l.user=t.currentUser();n.$broadcast("UpdatedPreferences",l.user);$("#FBModal").modal("hide")})}else{console.log("Updated Preferences");n.$broadcast("UpdatedPreferences",l.user)}}function d(){var t=e.api("/"+l.groupId+"?fields=cover,name");t.then(function(e){l.groupName=e.name;if(e.cover){l.groupPic=e.cover.source}else{l.groupPic=""}l.foundGroup=true;l.groupErr=""},function(e){l.foundGroup=false;l.groupErr="Group ID not found. Please try again."})}function m(){if(l.user.preferences){if(l.user.preferences.fbGroupIds){if(!!(l.user.preferences.fbGroupIds.indexOf(l.groupId)+1)){l.groupErr="You have already added this group.";return}else{l.user.preferences.fbGroupIds.push(l.groupId)}}else{l.user.preferences.fbGroupIds=[];l.user.preferences.fbGroupIds.push(l.groupId)}if(l.user.preferences.fbGroupNames){l.user.preferences.fbGroupNames.push(l.groupName)}else{l.user.preferences.fbGroupNames=[];l.user.preferences.fbGroupIds.push(l.groupName)}}else{l.user.preferences={fbGroupIds:[],fbGroupNames:[]};l.user.preferences.fbGroupIds.push(l.groupId);l.user.preferences.fbGroupNames.push(l.groupName)}if(t.isLoggedIn()){var e={preferences:l.user.preferences,email:l.user.email};t.updatePreferences(e).error(function(e){l.groupErr=e}).then(function(){console.log("Updated Preferences");l.user=t.currentUser();n.$broadcast("UpdatedPreferences",l.user);$("#FBModal").modal("hide");
})}else{console.log("Updated Preferences");n.$broadcast("UpdatedPreferences",l.user)}$("#FBModal").modal("hide")}function g(){if(!l.instaAuth){o.location.href="https://api.instagram.com/oauth/authorize/?client_id=a1d68979dac94f13ba591933bf8f23c1&redirect_uri=http://localhost:8090/social&response_type=token&scope=public_content"}else{r.jsonp("https://api.instagram.com/v1/tags/"+l.hashtag+"/media/recent",{method:"GET",params:{access_token:l.instaAuth,callback:"JSON_CALLBACK",count:20}}).then(function e(t){if(t.data.data[0]){l.hashPic=t.data.data[0].images.standard_resolution.url;l.foundHash=true}else{l.hashErr="No Data found for this hashtag."}console.info("media by tag",JSON.stringify(t))},function e(t){console.info("ERROR JSON: ",JSON.stringify(t))})}}function p(){}}})();